# ğŸ”¥RR_koa æ¡†æ¶

## åŸºäºä¸»åˆ†æ”¯å¼€å‘çš„ç½‘ç«™æœåŠ¡å™¨

**âš¡ è¯¥ç‰ˆæœ¬ç›®å‰å¯ä¾›ç½‘ç«™å‰ç«¯/åå°å…±åŒä½¿ç”¨**

- **_ğŸ”¥ å‰ç«¯_**ï¼šhttps://www.roadrunner2002.top/
  - **_å‰ç«¯ä»“åº“_**ï¼šhttps://github.com/A164759920/roadrunner
- **_ğŸ‘€ åå°_**ï¼šhttps://sls-website-ap-nanjing-xw8eu3mu-1313270013.cos-website.ap-nanjing.myqcloud.com/
  - **_åå°ä»“åº“_**ï¼šhttps://github.com/A164759920/roadrunner_backed

# ã€2023/5/6ã€‘

## 1.ğŸ“£ æ–°å¢ workflow

- **è‡ªåŠ¨å°†å½“å‰æ–‡ä»¶å¤¹æ¨é€è‡³è¿œç«¯**</br>
- **ä½¿ç”¨æ–¹æ³•:** **_npm run push_**

## 2.ğŸ“„ æ—¥å¿—ç³»ç»Ÿ v1.0

- **å“åº”æ—¥å¿—**
- **é”™è¯¯æ—¥å¿—**

## 3.éƒ¨åˆ†ä»£ç é‡æ„

- **email.service** æ•°æ®è„±æ•å¤„ç† + å¤šç§åœºæ™¯å¤ç”¨
- **ç¯å¢ƒå˜é‡** è„±æ•å¤„ç†
- **Event** å‘å¸ƒè®¢é˜…æ¨¡å— v1.0

# ã€2022/11/23ã€‘é‚®ä»¶æç¤ºåŠŸèƒ½ + æ¥å£è°ƒæ•´

## â‘ . æ›´æ–° service å±‚

**âš¡ ä¸»ç«™è¢«è®¿é—®æ—¶å°†è‡ªåŠ¨å‘é€é‚®ä»¶æé†’**
**è¯¦è§ service å±‚ email.service.js æ–‡ä»¶**

- **nodemailer**ï¼š å®ç°é‚®ä»¶å‘é€
- **lodash/throttle**ï¼š å®ç°**èŠ‚æµå‘é€(2min/æ¬¡)**

## â‘¡. æ¥å£è°ƒæ•´

- **ip.middleware** å°†ä¼šæŒ‚è½½**data_ip**å’Œ**parse_ip**ä¸¤é¡¹æ•°æ®
  - **data_ip**ï¼šæŸ¥è¯¢çš„ ip å½’å±åœ°ä¿¡æ¯
  - **parse_ip**ï¼šipv4 çš„ 32 ä½å½¢å¼
- **test_test** æ¥å£è¿”å›å€¼ä¼˜åŒ–
  - **UA çŠ¶æ€** + **Email çŠ¶æ€** åŒæ—¶è¿”å›

# ã€2022/11/16ã€‘é‡è¦æ›´æ–°

## â‘  é‡æ„éƒ¨åˆ† Controller

- testController ä¾›å‰ç«¯ä½¿ç”¨
- backedController ä¾›åå°ä½¿ç”¨

## â‘¡ æ›´æ–° middleware å±‚

- æ–°å¢ ua.middleware
  - å°† UA ç» parser åæŒ‚è½½è‡³ ctx.ua ä¸‹

## â‘¢ æ›´æ–° service å±‚

- æ–°å¢ ua.service
  - æä¾›åŒ…æ‹¬ä½†ä¸é™äºå­˜å‚¨ ua æ•°æ®ï¼Œè·å– ua æ•°æ®ç­‰åŠŸèƒ½

# ã€2022/11/16ã€‘ sequelize + mysql2 + æ›´æ–° middleware å±‚ + æ›´æ–° service å±‚

## ğŸ“„1.sequelize + mysql2 å®ç°æ•°æ®åº“è¿æ¥

ğŸ”¨**ä½¿ç”¨æ•°æ®åº“å‰éœ€å…ˆåœ¨.env ä¸­è¿›è¡Œé…ç½®**

- MYSQL_HOST = æ•°æ®åº“åŸŸå
- MYSQL_PORT = æ•°æ®åº“ç«¯å£å·
- MYSQL_USER = æ•°æ®åº“ç™»å½•ç”¨æˆ·
- MYSQL_PWD = ç™»å½•ç”¨æˆ·å¯†ç 
- MYSQL_DB = è¿æ¥æ•°æ®åº“åç§°

**æ•°æ®åº“åœ¨ ORM ä¸­æŠ½è±¡ä»¥ä¸‹ä¸¤å±‚**

- â‘ .database å±‚
  - è¯¥å±‚æ¯ä¸ª js æ–‡ä»¶å¯¼å‡ºæ•°æ®åº“æ•°æ®åº“å®ä¾‹
- â‘¡.model å±‚
  - è¯¥å±‚æ¯ä¸ª js æ–‡ä»¶å®šä¹‰å¹¶å¯¼å‡ºæ•°æ®åº“**_æ¯å¼ è¡¨_**çš„å…ƒç»„æ¨¡å‹ï¼ˆæ¯ä¸€è¡Œï¼‰

## ğŸ“„2.ip æŸ¥è¯¢ middleware

**â­ è·å–è°ƒç”¨æ¥å£è€…çš„ ip åœ°å€ï¼Œå¹¶æ ¹æ® ip åœ°å€æŸ¥è¯¢å½’å±åœ°ä¿¡æ¯**

- å¯¼å‡º:**_setIP å‡½æ•°_**
- æ¥å£:ç›®å‰è¯¥ä¸­é—´ä»¶ç”¨äº **http(s)://åŸŸå:ç«¯å£/test_test**

## ğŸ“„3.ip æŸ¥è¯¢ service

å…·ä½“å®ç°å°† **_ip middleware å±‚_** æŸ¥è¯¢çš„å†…å®¹ä¿å­˜åˆ°**_æ•°æ®åº“_**çš„æ“ä½œ</br>
è¯¦è§ **service/ip.service.js**

# ã€2022/11/12ã€‘ ä½¿ç”¨ pm2 æŒä¹…åŒ–å®ˆæŠ¤æœåŠ¡å™¨ + bug ä¿®å¤

- **_ç¯å¢ƒé…ç½®-åœ¨æœåŠ¡å™¨è¿è¡Œç¯å¢ƒä¸‹å®‰è£… PM2_**
- â‘ .å®‰è£…: **npm install pm2 -g**
- â‘¡. ä½¿ç”¨:
  - å¼€å‘è°ƒè¯•æƒ…å†µä¸‹å»ºè®®ä½¿ç”¨: **npm run dev** æˆ– **node index.js** ä¸å¯ç”¨ pm2
  - æŒä¹…åŒ–éƒ¨ç½²æƒ…å†µä¸‹: **npm run build** æˆ– **pm2 start index.js** å¯ç”¨ pm2 å®ˆæŠ¤ æœåŠ¡å™¨ã€‚
- â‘¢.pm2 å®˜ç½‘:https://pm2.keymetrics.io/docs/usage/quick-start/

- â‘£.ä¿®å¤äº† sts æ¥å£é‰´æƒå¤±è´¥æ—¶é”™è¯¯ä¸ŠæŠ¥çš„ bug

# ã€2022/11/3ã€‘è‡ªåŠ¨é…ç½® HTTPS è¯ä¹¦ + æœåŠ¡å™¨

- â‘  .env ä¸­è®¾ç½® IS_HTTPS = on
- â‘¡ å°† .key å’Œ .pem æ–‡ä»¶æ”¾å…¥ ssl æ–‡ä»¶å¤¹ä¸‹
- â‘¢ npm run dev å¼€å¯ HTTPS æœåŠ¡å™¨

# ã€2022/11/5ã€‘æ”¯æŒè…¾è®¯äº‘å­˜å‚¨æ¡¶ sts é‰´æƒæ¥å£

- **_ã€æ³¨æ„ã€‘_**:
  ä½¿ç”¨æ—¶å°†/controller/cosBucketController ä¸­<br>
  const { config, action } = require("../qcloud-cos/config.local.js");<br>
  æ›¿æ¢ä¸º:<br>
  const { config, action } = require("../qcloud-cos/config.default.js");<br>
  å¹¶åœ¨ config.default.js ä¸­é…ç½®ä½ çš„å­˜å‚¨æ¡¶ä¿¡æ¯<br>
- è¯¦è§ qcloud-cos æ–‡ä»¶å¤¹ä¸‹ README.md
